---
id: MalwareScan
title: Linux Malware Audit
---

## ClamAV

ClamAV is a popular open source antivirus available on the majority of Linux distro's. To install type the following command.

<code>sudo apt-get install clamav clamav-daemon</code>

<br/>

To update the database we must stop the freshclam.service.

<code>sudo systemctl stop clamav-freshclam.service</code>

<br/>

Once the service is stopped we can update the virus database with.

<code>sudo freshclam</code>

<br/>

With the database updated we can start a scan on the home directory.

<code>sudo clamscan -r /home</code>

<br/>

Once the home directory has been scanned a complete scan of the server can be run with.

<code>sudo clamscan -r -i --exclude-dir="^/sys" --bell / </code>

<br/><br/>

## Rkhunter

Rkhunter is a common choice when searching for rootkits and general vulnerabilities.

<code>sudo apt-get install rkhunter</code>

<br/>

Update the properties database prior to scanning.

<code>sudo rkhunter --propupd</code>

<br/>

Once the virus database has been updated the scan tool can be run with the following command.

<code>sudo rkhunter --checkall</code>

<br/><br/>

## Chkrootkit

Chkrootkit is similar in respect to Rkhunter.

<code>sudo apt-get install chkrootkit</code>

<br/>

Run the scan tool.

<code>sudo chkrootkit</code>

